var X=Object.defineProperty,Z=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var L=(i,e,u)=>e in i?X(i,e,{enumerable:!0,configurable:!0,writable:!0,value:u}):i[e]=u,D=(i,e)=>{for(var u in e||(e={}))ne.call(e,u)&&L(i,u,e[u]);if(N)for(var u of N(e))oe.call(e,u)&&L(i,u,e[u]);return i},G=(i,e)=>Z(i,ee(e));import{r as d,o as p,e as M,h as f,f as o,u as n,w as l,m as P,j as V,C as te,z as ae,aN as le,B as T,k as B,E as w,H as k,N as ie,J as se,aP as re,O as ue,Y as ce,l as y,t as E,i as H,P as de,F as me}from"./vendor.5f3776de.js";import{i as R,b as Y,d as ve,m as pe,r as be}from"./main.00ca56f4.js";import{_ as fe,a as _e,b as ge,c as Ie,d as we,e as ye,f as $e}from"./SalesTax.0c2d62b1.js";import{_ as Ve}from"./ExchangeRateConverter.10e7f2f6.js";import{_ as Be}from"./CreateCustomFields.eb15fef6.js";import{_ as Se}from"./TaxTypeModal.3e5442f7.js";import"./DragIcon.e66092fc.js";import"./SelectNotePopup.fd2d0184.js";import"./NoteModal.01dd9dcf.js";import"./payment.9388483c.js";import"./exchange-rate.e1b834d4.js";const Ce={class:"grid grid-cols-12 gap-8 mt-6 mb-8"},ke={class:"col-span-12 lg:col-span-5"},he={class:"col-span-12 lg:col-span-7"},Ue={key:0},je=f("h4",{class:"col-span-12 mt-4 mb-2"},"Transport Detail",-1),qe={props:{v:{type:Object,default:null},isLoading:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1}},setup(i){const e=R(),u=Y().selectedCompanySettings,h=ve().config.states;return(r,t)=>{const S=d("BaseCustomerSelectPopup"),_=d("BaseMultiselect"),s=d("BaseInputGroup"),m=d("BaseInputGrid"),v=d("BaseInput"),$=d("BaseDatePicker"),b=d("BaseIcon");return p(),M("div",Ce,[f("div",ke,[o(S,{modelValue:n(e).newInvoice.customer,"onUpdate:modelValue":t[0]||(t[0]=a=>n(e).newInvoice.customer=a),valid:i.v.customer_id,"content-loading":i.isLoading,type:"invoice"},null,8,["modelValue","valid","content-loading"]),o(m,{class:"col-span-12 md:grid-cols-2 mt-6"},{default:l(()=>[o(s,{label:r.$tc("invoices.reverse_charge")},{default:l(()=>[o(_,{options:["Yes","No"],modelValue:n(e).newInvoice.reverse_charge,"onUpdate:modelValue":t[1]||(t[1]=a=>n(e).newInvoice.reverse_charge=a),"open-direction":"right"},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:r.$tc("invoices.place_of_supply")},{default:l(()=>[o(_,{modelValue:n(e).newInvoice.place_of_supply,"onUpdate:modelValue":t[2]||(t[2]=a=>n(e).newInvoice.place_of_supply=a),options:n(h),label:"name","value-prop":"code","can-deselect":!0,"can-clear":!1,searchable:"","track-by":"name","open-direction":"right"},null,8,["modelValue","options"])]),_:1},8,["label"])]),_:1})]),f("div",he,[o(m,{class:"md:grid-cols-3"},{default:l(()=>[o(s,{label:r.$tc("invoices.type")},{default:l(()=>[o(_,{options:n(u).invoice_types,modelValue:n(e).newInvoice.invoice_type,"onUpdate:modelValue":t[3]||(t[3]=a=>n(e).newInvoice.invoice_type=a),label:"label","value-prop":"code","track-by":"code","open-direction":"right"},null,8,["options","modelValue"])]),_:1},8,["label"]),o(s,{label:r.$tc("invoices.tax_format")},{default:l(()=>[o(_,{options:n(u).tax_formats,modelValue:n(e).newInvoice.tax_format,"onUpdate:modelValue":t[4]||(t[4]=a=>n(e).newInvoice.tax_format=a),label:"label","value-prop":"code","track-by":"code","open-direction":"right"},null,8,["options","modelValue"])]),_:1},8,["label"]),o(s,{label:r.$t("invoices.invoice_number"),"content-loading":i.isLoading,error:i.v.invoice_number.$error&&i.v.invoice_number.$errors[0].$message,required:""},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.invoice_number,"onUpdate:modelValue":t[5]||(t[5]=a=>n(e).newInvoice.invoice_number=a),"content-loading":i.isLoading,onInput:t[6]||(t[6]=a=>i.v.invoice_number.$touch())},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),o(s,{label:r.$t("invoices.invoice_date"),required:"",error:i.v.invoice_date.$error&&i.v.invoice_date.$errors[0].$message},{default:l(()=>[o($,{modelValue:n(e).newInvoice.invoice_date,"onUpdate:modelValue":t[7]||(t[7]=a=>n(e).newInvoice.invoice_date=a),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label","error"]),o(s,{label:r.$t("invoices.due_date")},{default:l(()=>[o($,{modelValue:n(e).newInvoice.due_date,"onUpdate:modelValue":t[8]||(t[8]=a=>n(e).newInvoice.due_date=a),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:r.$t("invoices.delivery_date")},{default:l(()=>[o($,{modelValue:n(e).newInvoice.delivery_date,"onUpdate:modelValue":t[9]||(t[9]=a=>n(e).newInvoice.delivery_date=a),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:r.$t("invoices.ref_number"),error:i.v.reference_number.$error&&i.v.reference_number.$errors[0].$message},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.reference_number,"onUpdate:modelValue":t[10]||(t[10]=a=>n(e).newInvoice.reference_number=a),onInput:t[11]||(t[11]=a=>i.v.reference_number.$touch())},{left:l(a=>[o(b,{name:"HashtagIcon",class:P(a.class)},null,8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label","error"]),o(s,{label:r.$t("invoices.po_number")},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.po_number,"onUpdate:modelValue":t[12]||(t[12]=a=>n(e).newInvoice.po_number=a)},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:r.$t("invoices.challan_number")},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.challan_number,"onUpdate:modelValue":t[13]||(t[13]=a=>n(e).newInvoice.challan_number=a)},null,8,["modelValue"])]),_:1},8,["label"]),o(Ve,{store:n(e),"store-prop":"newInvoice",v:i.v,"is-loading":i.isLoading,"is-edit":i.isEdit,"customer-currency":n(e).newInvoice.currency_id},null,8,["store","v","is-loading","is-edit","customer-currency"])]),_:1}),n(u).has_transport_option=="YES"?(p(),M("div",Ue,[je,o(m,{class:"md:grid-cols-3"},{default:l(()=>[o(s,{label:r.$t("invoices.transport.e_way_number")},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.e_way_number,"onUpdate:modelValue":t[14]||(t[14]=a=>n(e).newInvoice.e_way_number=a)},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:r.$t("invoices.transport.gr_number")},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.gr_number,"onUpdate:modelValue":t[15]||(t[15]=a=>n(e).newInvoice.gr_number=a)},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:r.$t("invoices.transport.id")},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.transport_id,"onUpdate:modelValue":t[16]||(t[16]=a=>n(e).newInvoice.transport_id=a)},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:r.$t("invoices.transport.name")},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.transport_name,"onUpdate:modelValue":t[17]||(t[17]=a=>n(e).newInvoice.transport_name=a)},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:r.$t("invoices.transport.vehicle_number")},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.vehicle_number,"onUpdate:modelValue":t[18]||(t[18]=a=>n(e).newInvoice.vehicle_number=a)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})])):V("",!0)])])}}},Me=["onSubmit"],Pe={class:"flex"},Te={class:"block mt-10 invoice-foot lg:flex lg:justify-between lg:items-start"},Ee={class:"relative w-full lg:w-1/2 lg:mr-4"},Je={setup(i){const e=R(),u=Y(),h=pe(),r=be(),{t}=te();let S=ae(),_=le();const s="newInvoice";let m=T(!1);const v=T(!1),$=T(["customer","company","customerCustom","invoice","invoiceCustom"]);let b=B(()=>e.isFetchingInvoice||e.isFetchingInitialSettings),a=B(()=>g.value?t("invoices.edit_invoice"):t("invoices.new_invoice"));const x=B(()=>u.selectedCompanySettings.sales_tax_us_enabled==="YES"&&r.salesTaxUSEnabled);let g=B(()=>S.name==="invoices.edit");const z={invoice_date:{required:w.withMessage(t("validation.required"),k)},reference_number:{maxLength:w.withMessage(t("validation.price_maxlength"),ie(255))},customer_id:{required:w.withMessage(t("validation.required"),k)},invoice_number:{required:w.withMessage(t("validation.required"),k)},exchange_rate:{required:se(function(){return w.withMessage(t("validation.required"),k),e.showExchangeRate}),decimal:w.withMessage(t("validation.valid_exchange_rate"),re)}},C=ue(z,B(()=>e.newInvoice),{$scope:s});h.resetCustomFields(),C.value.$reset,e.resetCurrentInvoice(),e.fetchInvoiceInitialSettings(g.value),ce(()=>e.newInvoice.customer,c=>{c&&c.currency?e.newInvoice.selectedCurrency=c.currency:e.newInvoice.selectedCurrency=u.selectedCompanyCurrency});async function O(){if(C.value.$touch(),C.value.$invalid)return!1;m.value=!0;let c=G(D({},e.newInvoice),{sub_total:e.getSubTotal,total:e.getTotal,tax:e.getTotalTax});try{const I=await(g.value?e.updateInvoice:e.addInvoice)(c);_.push(`/admin/invoices/${I.data.data.id}/view`)}catch(U){console.error(U)}m.value=!1}return(c,U)=>{const I=d("BaseBreadcrumbItem"),A=d("BaseBreadcrumb"),j=d("BaseButton"),J=d("router-link"),F=d("BaseIcon"),K=d("BasePageHeader"),Q=d("BaseScrollPane"),W=d("BasePage");return p(),M(me,null,[o(fe),o(_e),o(Se),n(x)&&(!n(b)||n(S).query.customer)?(p(),y(ge,{key:0,store:n(e),"is-edit":n(g),"store-prop":"newInvoice",customer:n(e).newInvoice.customer},null,8,["store","is-edit","customer"])):V("",!0),o(W,{class:"relative invoice-create-page"},{default:l(()=>[f("form",{onSubmit:de(O,["prevent"])},[o(K,{title:n(a)},{actions:l(()=>[c.$route.name==="invoices.edit"?(p(),y(J,{key:0,to:`/invoices/pdf/${n(e).newInvoice.unique_hash}`,target:"_blank"},{default:l(()=>[o(j,{class:"mr-3",variant:"primary-outline",type:"button"},{default:l(()=>[f("span",Pe,E(c.$t("general.view_pdf")),1)]),_:1})]),_:1},8,["to"])):V("",!0),o(j,{loading:n(m),disabled:n(m),variant:"primary",type:"submit"},{left:l(q=>[n(m)?V("",!0):(p(),y(F,{key:0,name:"SaveIcon",class:P(q.class)},null,8,["class"]))]),default:l(()=>[H(" "+E(c.$t("invoices.save_invoice")),1)]),_:1},8,["loading","disabled"])]),default:l(()=>[o(A,null,{default:l(()=>[o(I,{title:c.$t("general.home"),to:"/admin/dashboard"},null,8,["title"]),o(I,{title:c.$tc("invoices.invoice",2),to:"/admin/invoices"},null,8,["title"]),c.$route.name==="invoices.edit"?(p(),y(I,{key:0,title:c.$t("invoices.edit_invoice"),to:"#",active:""},null,8,["title"])):(p(),y(I,{key:1,title:c.$t("invoices.new_invoice"),to:"#",active:""},null,8,["title"]))]),_:1})]),_:1},8,["title"]),o(qe,{v:n(C),"is-loading":n(b),"is-edit":n(g)},null,8,["v","is-loading","is-edit"]),o(Q,null,{default:l(()=>[o(Ie,{currency:n(e).newInvoice.selectedCurrency,"is-loading":n(b),"item-validation-scope":s,store:n(e),"store-prop":"newInvoice"},null,8,["currency","is-loading","store"]),f("div",Te,[f("div",Ee,[o(we,{store:n(e),"store-prop":"newInvoice",fields:$.value,type:"Invoice"},null,8,["store","fields"]),o(Be,{type:"Invoice","is-edit":n(g),"is-loading":n(b),store:n(e),"store-prop":"newInvoice","custom-field-scope":s,class:"mb-6"},null,8,["is-edit","is-loading","store"]),o(ye,{store:n(e),"store-prop":"newInvoice","component-name":"InvoiceTemplate","is-mark-as-default":v.value},null,8,["store","is-mark-as-default"])]),o($e,{currency:n(e).newInvoice.selectedCurrency,"is-loading":n(b),store:n(e),"store-prop":"newInvoice","tax-popup-type":"invoice"},null,8,["currency","is-loading","store"])]),o(j,{loading:n(m),disabled:n(m),variant:"primary",type:"submit",class:"float-right"},{left:l(q=>[n(m)?V("",!0):(p(),y(F,{key:0,name:"SaveIcon",class:P(q.class)},null,8,["class"]))]),default:l(()=>[H(" "+E(c.$t("invoices.save_invoice")),1)]),_:1},8,["loading","disabled"])]),_:1})],40,Me)]),_:1})],64)}}};export{Je as default};
