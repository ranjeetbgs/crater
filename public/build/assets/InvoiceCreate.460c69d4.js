var X=Object.defineProperty,Z=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var F=(i,e,u)=>e in i?X(i,e,{enumerable:!0,configurable:!0,writable:!0,value:u}):i[e]=u,N=(i,e)=>{for(var u in e||(e={}))ne.call(e,u)&&F(i,u,e[u]);if(E)for(var u of E(e))oe.call(e,u)&&F(i,u,e[u]);return i},L=(i,e)=>Z(i,ee(e));import{r as c,o as p,e as q,h as _,f as o,u as n,w as l,j as V,C as te,z as ae,aN as le,B as M,k as $,E as I,H as C,N as ie,J as se,aP as re,O as ue,Y as de,l as w,t as P,m as D,i as G,P as ce,F as me}from"./vendor.5f3776de.js";import{i as R,b as Y,d as ve,m as pe,r as _e}from"./main.f6fb8b4b.js";import{_ as be,a as fe,b as ge,c as Ie,d as we,e as ye,f as Ve}from"./SalesTax.b1fcfc66.js";import{_ as $e}from"./ExchangeRateConverter.0ecd1820.js";import{_ as Be}from"./CreateCustomFields.242ae18f.js";import{_ as Se}from"./TaxTypeModal.6d9065e8.js";import"./DragIcon.8692f1a0.js";import"./SelectNotePopup.28e11752.js";import"./NoteModal.75756e51.js";import"./payment.7ad7a1f1.js";import"./exchange-rate.56e6e448.js";const Ce={class:"grid grid-cols-12 gap-8 mt-6 mb-8"},ke={class:"col-span-12 lg:col-span-5"},he={class:"col-span-12 lg:col-span-7"},Ue={key:0},je=_("h4",{class:"col-span-12 mt-4 mb-2"},"Transport Detail",-1),qe={props:{v:{type:Object,default:null},isLoading:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1}},setup(i){const e=R(),u=Y().selectedCompanySettings,k=ve().config.states;return(r,t)=>{const B=c("BaseCustomerSelectPopup"),b=c("BaseMultiselect"),s=c("BaseInputGroup"),m=c("BaseInputGrid"),v=c("BaseInput"),y=c("BaseDatePicker");return p(),q("div",Ce,[_("div",ke,[o(B,{modelValue:n(e).newInvoice.customer,"onUpdate:modelValue":t[0]||(t[0]=a=>n(e).newInvoice.customer=a),valid:i.v.customer_id,"content-loading":i.isLoading,type:"invoice"},null,8,["modelValue","valid","content-loading"]),o(m,{class:"col-span-12 md:grid-cols-2 mt-6"},{default:l(()=>[o(s,{label:r.$tc("invoices.reverse_charge")},{default:l(()=>[o(b,{options:["Yes","No"],modelValue:n(e).newInvoice.reverse_charge,"onUpdate:modelValue":t[1]||(t[1]=a=>n(e).newInvoice.reverse_charge=a),"open-direction":"right"},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:r.$tc("invoices.place_of_supply")},{default:l(()=>[o(b,{modelValue:n(e).newInvoice.place_of_supply,"onUpdate:modelValue":t[2]||(t[2]=a=>n(e).newInvoice.place_of_supply=a),options:n(k),label:"name","value-prop":"code","can-deselect":!0,"can-clear":!1,searchable:"","track-by":"name","open-direction":"right"},null,8,["modelValue","options"])]),_:1},8,["label"])]),_:1})]),_("div",he,[o(m,{class:"md:grid-cols-3"},{default:l(()=>[o(s,{label:r.$tc("invoices.type")},{default:l(()=>[o(b,{options:n(u).invoice_types,modelValue:n(e).newInvoice.invoice_type,"onUpdate:modelValue":t[3]||(t[3]=a=>n(e).newInvoice.invoice_type=a),label:"label","value-prop":"code","track-by":"code","open-direction":"right"},null,8,["options","modelValue"])]),_:1},8,["label"]),o(s,{label:r.$tc("invoices.tax_format")},{default:l(()=>[o(b,{options:n(u).tax_formats,modelValue:n(e).newInvoice.tax_format,"onUpdate:modelValue":t[4]||(t[4]=a=>n(e).newInvoice.tax_format=a),label:"label","value-prop":"code","track-by":"code","open-direction":"right"},null,8,["options","modelValue"])]),_:1},8,["label"]),o(s,{label:r.$t("invoices.invoice_number"),"content-loading":i.isLoading,error:i.v.invoice_number.$error&&i.v.invoice_number.$errors[0].$message,required:""},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.invoice_number,"onUpdate:modelValue":t[5]||(t[5]=a=>n(e).newInvoice.invoice_number=a),"content-loading":i.isLoading,onInput:t[6]||(t[6]=a=>i.v.invoice_number.$touch())},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),o(s,{label:r.$t("invoices.invoice_date"),required:"",error:i.v.invoice_date.$error&&i.v.invoice_date.$errors[0].$message},{default:l(()=>[o(y,{modelValue:n(e).newInvoice.invoice_date,"onUpdate:modelValue":t[7]||(t[7]=a=>n(e).newInvoice.invoice_date=a),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label","error"]),o(s,{label:r.$t("invoices.due_date")},{default:l(()=>[o(y,{modelValue:n(e).newInvoice.due_date,"onUpdate:modelValue":t[8]||(t[8]=a=>n(e).newInvoice.due_date=a),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:r.$t("invoices.delivery_date")},{default:l(()=>[o(y,{modelValue:n(e).newInvoice.delivery_date,"onUpdate:modelValue":t[9]||(t[9]=a=>n(e).newInvoice.delivery_date=a),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:r.$t("invoices.ref_number")},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.ref_number,"onUpdate:modelValue":t[10]||(t[10]=a=>n(e).newInvoice.ref_number=a)},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:r.$t("invoices.po_number")},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.po_number,"onUpdate:modelValue":t[11]||(t[11]=a=>n(e).newInvoice.po_number=a)},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:r.$t("invoices.chalan_number")},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.chalan_number,"onUpdate:modelValue":t[12]||(t[12]=a=>n(e).newInvoice.chalan_number=a)},null,8,["modelValue"])]),_:1},8,["label"]),o($e,{store:n(e),"store-prop":"newInvoice",v:i.v,"is-loading":i.isLoading,"is-edit":i.isEdit,"customer-currency":n(e).newInvoice.currency_id},null,8,["store","v","is-loading","is-edit","customer-currency"])]),_:1}),n(u).has_transport_option=="YES"?(p(),q("div",Ue,[je,o(m,{class:"md:grid-cols-3"},{default:l(()=>[o(s,{label:r.$t("invoices.transport.e_way_number")},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.e_way_number,"onUpdate:modelValue":t[13]||(t[13]=a=>n(e).newInvoice.e_way_number=a)},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:r.$t("invoices.transport.gr_number")},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.gr_number,"onUpdate:modelValue":t[14]||(t[14]=a=>n(e).newInvoice.gr_number=a)},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:r.$t("invoices.transport.id")},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.transport_id,"onUpdate:modelValue":t[15]||(t[15]=a=>n(e).newInvoice.transport_id=a)},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:r.$t("invoices.transport.name")},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.transport_name,"onUpdate:modelValue":t[16]||(t[16]=a=>n(e).newInvoice.transport_name=a)},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:r.$t("invoices.transport.vehicle_number")},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.vehicle_number,"onUpdate:modelValue":t[17]||(t[17]=a=>n(e).newInvoice.vehicle_number=a)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})])):V("",!0)])])}}},Me=["onSubmit"],Pe={class:"flex"},Te={class:"block mt-10 invoice-foot lg:flex lg:justify-between lg:items-start"},Ee={class:"relative w-full lg:w-1/2 lg:mr-4"},Je={setup(i){const e=R(),u=Y(),k=pe(),r=_e(),{t}=te();let B=ae(),b=le();const s="newInvoice";let m=M(!1);const v=M(!1),y=M(["customer","company","customerCustom","invoice","invoiceCustom"]);let a=$(()=>e.isFetchingInvoice||e.isFetchingInitialSettings),H=$(()=>f.value?t("invoices.edit_invoice"):t("invoices.new_invoice"));const x=$(()=>u.selectedCompanySettings.sales_tax_us_enabled==="YES"&&r.salesTaxUSEnabled);let f=$(()=>B.name==="invoices.edit");const z={invoice_date:{required:I.withMessage(t("validation.required"),C)},reference_number:{maxLength:I.withMessage(t("validation.price_maxlength"),ie(255))},customer_id:{required:I.withMessage(t("validation.required"),C)},invoice_number:{required:I.withMessage(t("validation.required"),C)},exchange_rate:{required:se(function(){return I.withMessage(t("validation.required"),C),e.showExchangeRate}),decimal:I.withMessage(t("validation.valid_exchange_rate"),re)}},S=ue(z,$(()=>e.newInvoice),{$scope:s});k.resetCustomFields(),S.value.$reset,e.resetCurrentInvoice(),e.fetchInvoiceInitialSettings(f.value),de(()=>e.newInvoice.customer,d=>{d&&d.currency?e.newInvoice.selectedCurrency=d.currency:e.newInvoice.selectedCurrency=u.selectedCompanyCurrency});async function O(){if(S.value.$touch(),S.value.$invalid)return!1;m.value=!0;let d=L(N({},e.newInvoice),{sub_total:e.getSubTotal,total:e.getTotal,tax:e.getTotalTax});try{const g=await(f.value?e.updateInvoice:e.addInvoice)(d);b.push(`/admin/invoices/${g.data.data.id}/view`)}catch(h){console.error(h)}m.value=!1}return(d,h)=>{const g=c("BaseBreadcrumbItem"),A=c("BaseBreadcrumb"),U=c("BaseButton"),J=c("router-link"),T=c("BaseIcon"),K=c("BasePageHeader"),Q=c("BaseScrollPane"),W=c("BasePage");return p(),q(me,null,[o(be),o(fe),o(Se),n(x)&&(!n(a)||n(B).query.customer)?(p(),w(ge,{key:0,store:n(e),"is-edit":n(f),"store-prop":"newInvoice",customer:n(e).newInvoice.customer},null,8,["store","is-edit","customer"])):V("",!0),o(W,{class:"relative invoice-create-page"},{default:l(()=>[_("form",{onSubmit:ce(O,["prevent"])},[o(K,{title:n(H)},{actions:l(()=>[d.$route.name==="invoices.edit"?(p(),w(J,{key:0,to:`/invoices/pdf/${n(e).newInvoice.unique_hash}`,target:"_blank"},{default:l(()=>[o(U,{class:"mr-3",variant:"primary-outline",type:"button"},{default:l(()=>[_("span",Pe,P(d.$t("general.view_pdf")),1)]),_:1})]),_:1},8,["to"])):V("",!0),o(U,{loading:n(m),disabled:n(m),variant:"primary",type:"submit"},{left:l(j=>[n(m)?V("",!0):(p(),w(T,{key:0,name:"SaveIcon",class:D(j.class)},null,8,["class"]))]),default:l(()=>[G(" "+P(d.$t("invoices.save_invoice")),1)]),_:1},8,["loading","disabled"])]),default:l(()=>[o(A,null,{default:l(()=>[o(g,{title:d.$t("general.home"),to:"/admin/dashboard"},null,8,["title"]),o(g,{title:d.$tc("invoices.invoice",2),to:"/admin/invoices"},null,8,["title"]),d.$route.name==="invoices.edit"?(p(),w(g,{key:0,title:d.$t("invoices.edit_invoice"),to:"#",active:""},null,8,["title"])):(p(),w(g,{key:1,title:d.$t("invoices.new_invoice"),to:"#",active:""},null,8,["title"]))]),_:1})]),_:1},8,["title"]),o(qe,{v:n(S),"is-loading":n(a),"is-edit":n(f)},null,8,["v","is-loading","is-edit"]),o(Q,null,{default:l(()=>[o(Ie,{currency:n(e).newInvoice.selectedCurrency,"is-loading":n(a),"item-validation-scope":s,store:n(e),"store-prop":"newInvoice"},null,8,["currency","is-loading","store"]),_("div",Te,[_("div",Ee,[o(we,{store:n(e),"store-prop":"newInvoice",fields:y.value,type:"Invoice"},null,8,["store","fields"]),o(Be,{type:"Invoice","is-edit":n(f),"is-loading":n(a),store:n(e),"store-prop":"newInvoice","custom-field-scope":s,class:"mb-6"},null,8,["is-edit","is-loading","store"]),o(ye,{store:n(e),"store-prop":"newInvoice","component-name":"InvoiceTemplate","is-mark-as-default":v.value},null,8,["store","is-mark-as-default"])]),o(Ve,{currency:n(e).newInvoice.selectedCurrency,"is-loading":n(a),store:n(e),"store-prop":"newInvoice","tax-popup-type":"invoice"},null,8,["currency","is-loading","store"])]),o(U,{loading:n(m),disabled:n(m),variant:"primary",type:"submit",class:"float-right"},{left:l(j=>[n(m)?V("",!0):(p(),w(T,{key:0,name:"SaveIcon",class:D(j.class)},null,8,["class"]))]),default:l(()=>[G(" "+P(d.$t("invoices.save_invoice")),1)]),_:1},8,["loading","disabled"])]),_:1})],40,Me)]),_:1})],64)}}};export{Je as default};
