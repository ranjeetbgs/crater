var X=Object.defineProperty,Z=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var E=(t,e,c)=>e in t?X(t,e,{enumerable:!0,configurable:!0,writable:!0,value:c}):t[e]=c,F=(t,e)=>{for(var c in e||(e={}))ne.call(e,c)&&E(t,c,e[c]);if(T)for(var c of T(e))oe.call(e,c)&&E(t,c,e[c]);return t},N=(t,e)=>Z(t,ee(e));import{r as u,o as g,e as j,h as b,f as o,u as n,w as l,j as V,C as te,z as ae,aN as ie,B as q,k as $,E as w,H as S,N as le,J as se,aP as de,O as ce,Y as re,l as _,t as M,m as D,i as G,P as ue,F as me}from"./vendor.5f3776de.js";import{i as R,b as H,d as ve,m as ge,r as be}from"./main.29275627.js";import{_ as pe,a as fe,b as Ie,c as we,d as _e,e as ye,f as Ve}from"./SalesTax.90dd11f3.js";import{_ as $e}from"./ExchangeRateConverter.f17a76b3.js";import{_ as Be}from"./CreateCustomFields.42c49577.js";import{_ as Le}from"./TaxTypeModal.d95b8476.js";import"./DragIcon.0eb62750.js";import"./SelectNotePopup.1507a14a.js";import"./NoteModal.2dfbd65c.js";import"./payment.0350fb5e.js";import"./exchange-rate.592919fb.js";const Se={class:"grid grid-cols-12 gap-8 mt-6 mb-8"},Ce={class:"col-span-12 lg:col-span-5"},ke={class:"col-span-12 lg:col-span-7"},he={key:0},Ue=b("h4",{class:"col-span-12 mt-4 mb-2"},"Transport Detail",-1),je={props:{v:{type:Object,default:null},isLoading:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1}},setup(t){const e=R(),c=H().selectedCompanySettings,C=ve().config.states;return(d,a)=>{const B=u("BaseCustomerSelectPopup"),p=u("BaseMultiselect"),s=u("BaseInputGroup"),m=u("BaseInputGrid"),v=u("BaseInput"),y=u("BaseDatePicker");return g(),j("div",Se,[b("div",Ce,[o(B,{modelValue:n(e).newInvoice.customer,"onUpdate:modelValue":a[0]||(a[0]=i=>n(e).newInvoice.customer=i),valid:t.v.customer_id,"content-loading":t.isLoading,type:"invoice"},null,8,["modelValue","valid","content-loading"]),o(m,{class:"col-span-12 md:grid-cols-2 mt-6"},{default:l(()=>[o(s,{label:d.$tc("invoices.reverse_charge")},{default:l(()=>[o(p,{options:["Yes","No"],modelValue:n(e).newInvoice.reverse_charge,"onUpdate:modelValue":a[1]||(a[1]=i=>n(e).newInvoice.reverse_charge=i),"open-direction":"right"},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:d.$tc("invoices.place_of_supply")},{default:l(()=>[o(p,{modelValue:n(e).newInvoice.place_of_supply,"onUpdate:modelValue":a[2]||(a[2]=i=>n(e).newInvoice.place_of_supply=i),options:n(C),label:"name","value-prop":"code","can-deselect":!0,"can-clear":!1,searchable:"","track-by":"name","open-direction":"right"},null,8,["modelValue","options"])]),_:1},8,["label"])]),_:1})]),b("div",ke,[o(m,{class:"md:grid-cols-3"},{default:l(()=>[o(s,{label:d.$tc("invoices.type")},{default:l(()=>[o(p,{options:n(c).invoice_types,modelValue:n(e).newInvoice.invoice_type,"onUpdate:modelValue":a[3]||(a[3]=i=>n(e).newInvoice.invoice_type=i),label:"label","value-prop":"code","track-by":"code","open-direction":"right"},null,8,["options","modelValue"])]),_:1},8,["label"]),o(s,{label:d.$tc("invoices.tax_format")},{default:l(()=>[o(p,{options:n(c).tax_formats,modelValue:n(e).newInvoice.tax_format,"onUpdate:modelValue":a[4]||(a[4]=i=>n(e).newInvoice.tax_format=i),label:"label","value-prop":"code","track-by":"code","open-direction":"right"},null,8,["options","modelValue"])]),_:1},8,["label"]),o(s,{label:d.$t("invoices.invoice_number"),"content-loading":t.isLoading,error:t.v.invoice_number.$error&&t.v.invoice_number.$errors[0].$message,required:""},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.invoice_number,"onUpdate:modelValue":a[5]||(a[5]=i=>n(e).newInvoice.invoice_number=i),"content-loading":t.isLoading,onInput:a[6]||(a[6]=i=>t.v.invoice_number.$touch())},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),o(s,{label:d.$t("invoices.invoice_date"),"content-loading":t.isLoading,required:"",error:t.v.invoice_date.$error&&t.v.invoice_date.$errors[0].$message},{default:l(()=>[o(y,{modelValue:n(e).newInvoice.invoice_date,"onUpdate:modelValue":a[7]||(a[7]=i=>n(e).newInvoice.invoice_date=i),"content-loading":t.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),o(s,{label:d.$t("invoices.due_date"),"content-loading":t.isLoading},{default:l(()=>[o(y,{modelValue:n(e).newInvoice.due_date,"onUpdate:modelValue":a[8]||(a[8]=i=>n(e).newInvoice.due_date=i),"content-loading":t.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),o(s,{label:d.$t("invoices.delivery_date"),"content-loading":t.isLoading},{default:l(()=>[o(y,{modelValue:n(e).newInvoice.delivery_date,"onUpdate:modelValue":a[9]||(a[9]=i=>n(e).newInvoice.delivery_date=i),"content-loading":t.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),o(s,{label:d.$t("invoices.ref_number"),"content-loading":t.isLoading},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.ref_number,"onUpdate:modelValue":a[10]||(a[10]=i=>n(e).newInvoice.ref_number=i),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),o(s,{label:d.$t("invoices.po_number"),"content-loading":t.isLoading},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.po_number,"onUpdate:modelValue":a[11]||(a[11]=i=>n(e).newInvoice.po_number=i),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),o(s,{label:d.$t("invoices.chalan_number"),"content-loading":t.isLoading},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.chalan_number,"onUpdate:modelValue":a[12]||(a[12]=i=>n(e).newInvoice.chalan_number=i),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),o($e,{store:n(e),"store-prop":"newInvoice",v:t.v,"is-loading":t.isLoading,"is-edit":t.isEdit,"customer-currency":n(e).newInvoice.currency_id},null,8,["store","v","is-loading","is-edit","customer-currency"])]),_:1}),n(c).has_transport_option?(g(),j("div",he,[Ue,o(m,{class:"md:grid-cols-3"},{default:l(()=>[o(s,{label:d.$t("invoices.transport.e_way_number"),"content-loading":t.isLoading},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.e_way_number,"onUpdate:modelValue":a[13]||(a[13]=i=>n(e).newInvoice.e_way_number=i),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),o(s,{label:d.$t("invoices.transport.gr_number"),"content-loading":t.isLoading},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.gr_number,"onUpdate:modelValue":a[14]||(a[14]=i=>n(e).newInvoice.gr_number=i),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),o(s,{label:d.$t("invoices.transport.id"),"content-loading":t.isLoading},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.transport_id,"onUpdate:modelValue":a[15]||(a[15]=i=>n(e).newInvoice.transport_id=i),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),o(s,{label:d.$t("invoices.transport.name"),"content-loading":t.isLoading},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.transport_name,"onUpdate:modelValue":a[16]||(a[16]=i=>n(e).newInvoice.transport_name=i),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),o(s,{label:d.$t("invoices.transport.vehicle_number"),"content-loading":t.isLoading},{default:l(()=>[o(v,{modelValue:n(e).newInvoice.vehicle_number,"onUpdate:modelValue":a[17]||(a[17]=i=>n(e).newInvoice.vehicle_number=i),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"])]),_:1})])):V("",!0)])])}}},qe=["onSubmit"],Me={class:"flex"},Pe={class:"block mt-10 invoice-foot lg:flex lg:justify-between lg:items-start"},Te={class:"relative w-full lg:w-1/2 lg:mr-4"},Je={setup(t){const e=R(),c=H(),C=ge(),d=be(),{t:a}=te();let B=ae(),p=ie();const s="newInvoice";let m=q(!1);const v=q(!1),y=q(["customer","company","customerCustom","invoice","invoiceCustom"]);let i=$(()=>e.isFetchingInvoice||e.isFetchingInitialSettings),Y=$(()=>f.value?a("invoices.edit_invoice"):a("invoices.new_invoice"));const x=$(()=>c.selectedCompanySettings.sales_tax_us_enabled==="YES"&&d.salesTaxUSEnabled);let f=$(()=>B.name==="invoices.edit");const z={invoice_date:{required:w.withMessage(a("validation.required"),S)},reference_number:{maxLength:w.withMessage(a("validation.price_maxlength"),le(255))},customer_id:{required:w.withMessage(a("validation.required"),S)},invoice_number:{required:w.withMessage(a("validation.required"),S)},exchange_rate:{required:se(function(){return w.withMessage(a("validation.required"),S),e.showExchangeRate}),decimal:w.withMessage(a("validation.valid_exchange_rate"),de)}},L=ce(z,$(()=>e.newInvoice),{$scope:s});C.resetCustomFields(),L.value.$reset,e.resetCurrentInvoice(),e.fetchInvoiceInitialSettings(f.value),re(()=>e.newInvoice.customer,r=>{r&&r.currency?e.newInvoice.selectedCurrency=r.currency:e.newInvoice.selectedCurrency=c.selectedCompanyCurrency});async function O(){if(L.value.$touch(),L.value.$invalid)return!1;m.value=!0;let r=N(F({},e.newInvoice),{sub_total:e.getSubTotal,total:e.getTotal,tax:e.getTotalTax});try{const I=await(f.value?e.updateInvoice:e.addInvoice)(r);p.push(`/admin/invoices/${I.data.data.id}/view`)}catch(k){console.error(k)}m.value=!1}return(r,k)=>{const I=u("BaseBreadcrumbItem"),A=u("BaseBreadcrumb"),h=u("BaseButton"),J=u("router-link"),P=u("BaseIcon"),K=u("BasePageHeader"),Q=u("BaseScrollPane"),W=u("BasePage");return g(),j(me,null,[o(pe),o(fe),o(Le),n(x)&&(!n(i)||n(B).query.customer)?(g(),_(Ie,{key:0,store:n(e),"is-edit":n(f),"store-prop":"newInvoice",customer:n(e).newInvoice.customer},null,8,["store","is-edit","customer"])):V("",!0),o(W,{class:"relative invoice-create-page"},{default:l(()=>[b("form",{onSubmit:ue(O,["prevent"])},[o(K,{title:n(Y)},{actions:l(()=>[r.$route.name==="invoices.edit"?(g(),_(J,{key:0,to:`/invoices/pdf/${n(e).newInvoice.unique_hash}`,target:"_blank"},{default:l(()=>[o(h,{class:"mr-3",variant:"primary-outline",type:"button"},{default:l(()=>[b("span",Me,M(r.$t("general.view_pdf")),1)]),_:1})]),_:1},8,["to"])):V("",!0),o(h,{loading:n(m),disabled:n(m),variant:"primary",type:"submit"},{left:l(U=>[n(m)?V("",!0):(g(),_(P,{key:0,name:"SaveIcon",class:D(U.class)},null,8,["class"]))]),default:l(()=>[G(" "+M(r.$t("invoices.save_invoice")),1)]),_:1},8,["loading","disabled"])]),default:l(()=>[o(A,null,{default:l(()=>[o(I,{title:r.$t("general.home"),to:"/admin/dashboard"},null,8,["title"]),o(I,{title:r.$tc("invoices.invoice",2),to:"/admin/invoices"},null,8,["title"]),r.$route.name==="invoices.edit"?(g(),_(I,{key:0,title:r.$t("invoices.edit_invoice"),to:"#",active:""},null,8,["title"])):(g(),_(I,{key:1,title:r.$t("invoices.new_invoice"),to:"#",active:""},null,8,["title"]))]),_:1})]),_:1},8,["title"]),o(je,{v:n(L),"is-loading":n(i),"is-edit":n(f)},null,8,["v","is-loading","is-edit"]),o(Q,null,{default:l(()=>[o(we,{currency:n(e).newInvoice.selectedCurrency,"is-loading":n(i),"item-validation-scope":s,store:n(e),"store-prop":"newInvoice"},null,8,["currency","is-loading","store"]),b("div",Pe,[b("div",Te,[o(_e,{store:n(e),"store-prop":"newInvoice",fields:y.value,type:"Invoice"},null,8,["store","fields"]),o(Be,{type:"Invoice","is-edit":n(f),"is-loading":n(i),store:n(e),"store-prop":"newInvoice","custom-field-scope":s,class:"mb-6"},null,8,["is-edit","is-loading","store"]),o(ye,{store:n(e),"store-prop":"newInvoice","component-name":"InvoiceTemplate","is-mark-as-default":v.value},null,8,["store","is-mark-as-default"])]),o(Ve,{currency:n(e).newInvoice.selectedCurrency,"is-loading":n(i),store:n(e),"store-prop":"newInvoice","tax-popup-type":"invoice"},null,8,["currency","is-loading","store"])]),o(h,{loading:n(m),disabled:n(m),variant:"primary",type:"submit",class:"float-right"},{left:l(U=>[n(m)?V("",!0):(g(),_(P,{key:0,name:"SaveIcon",class:D(U.class)},null,8,["class"]))]),default:l(()=>[G(" "+M(r.$t("invoices.save_invoice")),1)]),_:1},8,["loading","disabled"])]),_:1})],40,qe)]),_:1})],64)}}};export{Je as default};
