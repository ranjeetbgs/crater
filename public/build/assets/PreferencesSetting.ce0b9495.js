var R=Object.defineProperty;var M=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var U=(m,i,l)=>i in m?R(m,i,{enumerable:!0,configurable:!0,writable:!0,value:l}):m[i]=l,w=(m,i)=>{for(var l in i||(i={}))A.call(i,l)&&U(m,l,i[l]);if(M)for(var l of M(i))J.call(i,l)&&U(m,l,i[l]);return m};import{C as K,B as q,a0 as L,k as f,Y as Q,E as b,H as y,O as W,r as p,o as z,e as X,f as s,w as u,u as e,m as E,i as F,t as N,h as O,P as Y,x as h,l as ee,j as te}from"./vendor.5f3776de.js";import{b as ae,d as ne}from"./main.e56a056f.js";const se=["onSubmit"],le=["onSubmit"],ue={setup(m){const i=ae(),l=ne(),{t:g,tm:oe}=K();let v=q(!1),$=q(!1),d=q(!1);const n=L(w({},i.selectedCompanySettings));f(()=>l.config.retrospective_edits.map(t=>(t.title=g(t.key),t))),Q(()=>n.carbon_date_format,t=>{if(t){const a=l.dateFormats.find(c=>c.carbon_format_value===t);n.moment_date_format=a.moment_format_value}});const S=f({get:()=>n.discount_per_item==="YES",set:async t=>{const a=t?"YES":"NO";let c={settings:{discount_per_item:a}};n.discount_per_item=a,await i.updateCompanySettings({data:c,message:"general.setting_updated"})}}),k=f({get:()=>n.has_transport_option==="YES",set:async t=>{const a=t?"YES":"NO";let c={settings:{has_transport_option:a}};n.has_transport_option=a,await i.updateCompanySettings({data:c,message:"general.setting_updated"})}}),V=f({get:()=>n.automatically_expire_public_links==="YES",set:async t=>{const a=t?"YES":"NO";n.automatically_expire_public_links=a}}),G=f(()=>({currency:{required:b.withMessage(g("validation.required"),y)},language:{required:b.withMessage(g("validation.required"),y)},carbon_date_format:{required:b.withMessage(g("validation.required"),y)},moment_date_format:{required:b.withMessage(g("validation.required"),y)},time_zone:{required:b.withMessage(g("validation.required"),y)},fiscal_year:{required:b.withMessage(g("validation.required"),y)}})),r=W(G,f(()=>n));P();async function P(){d.value=!0,Promise.all([l.fetchCurrencies(),l.fetchDateFormats(),l.fetchTimeZones()]).then(([t])=>{d.value=!1})}async function j(){if(r.value.$touch(),r.value.$invalid)return;let t={settings:w({},n)};v.value=!0,delete t.settings.link_expiry_days,await i.updateCompanySettings({data:t,message:"settings.preferences.updated_message"}),v.value=!1}async function x(){$.value=!0,await i.updateCompanySettings({data:{settings:{link_expiry_days:n.link_expiry_days,automatically_expire_public_links:n.automatically_expire_public_links}},message:"settings.preferences.updated_message"}),$.value=!1}return(t,a)=>{const c=p("BaseMultiselect"),_=p("BaseInputGroup"),T=p("BaseInputGrid"),C=p("BaseIcon"),I=p("BaseButton"),D=p("BaseDivider"),B=p("BaseSwitchSection"),Z=p("BaseInput"),H=p("BaseSettingCard");return z(),X("form",{action:"",class:"relative",onSubmit:Y(j,["prevent"])},[s(H,{title:t.$t("settings.menu_title.preferences"),description:t.$t("settings.preferences.general_settings")},{default:u(()=>[s(T,{class:"mt-5"},{default:u(()=>[s(_,{"content-loading":e(d),label:t.$tc("settings.preferences.currency"),"help-text":t.$t("settings.preferences.company_currency_unchangeable"),error:e(r).currency.$error&&e(r).currency.$errors[0].$message,required:""},{default:u(()=>[s(c,{modelValue:e(n).currency,"onUpdate:modelValue":a[0]||(a[0]=o=>e(n).currency=o),"content-loading":e(d),options:e(l).currencies,label:"name","value-prop":"id",searchable:!0,"track-by":"name",invalid:e(r).currency.$error,disabled:"",class:"w-full"},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["content-loading","label","help-text","error"]),s(_,{label:t.$tc("settings.preferences.default_language"),"content-loading":e(d),error:e(r).language.$error&&e(r).language.$errors[0].$message,required:""},{default:u(()=>[s(c,{modelValue:e(n).language,"onUpdate:modelValue":a[1]||(a[1]=o=>e(n).language=o),"content-loading":e(d),options:e(l).config.languages,label:"name","value-prop":"code",class:"w-full","track-by":"name",searchable:!0,invalid:e(r).language.$error},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),s(_,{label:t.$tc("settings.preferences.time_zone"),"content-loading":e(d),error:e(r).time_zone.$error&&e(r).time_zone.$errors[0].$message,required:""},{default:u(()=>[s(c,{modelValue:e(n).time_zone,"onUpdate:modelValue":a[2]||(a[2]=o=>e(n).time_zone=o),"content-loading":e(d),options:e(l).timeZones,label:"key","value-prop":"value","track-by":"key",searchable:!0,invalid:e(r).time_zone.$error},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),s(_,{label:t.$tc("settings.preferences.date_format"),"content-loading":e(d),error:e(r).carbon_date_format.$error&&e(r).carbon_date_format.$errors[0].$message,required:""},{default:u(()=>[s(c,{modelValue:e(n).carbon_date_format,"onUpdate:modelValue":a[3]||(a[3]=o=>e(n).carbon_date_format=o),"content-loading":e(d),options:e(l).dateFormats,label:"display_date","value-prop":"carbon_format_value","track-by":"display_date",searchable:"",invalid:e(r).carbon_date_format.$error,class:"w-full"},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),s(_,{"content-loading":e(d),error:e(r).fiscal_year.$error&&e(r).fiscal_year.$errors[0].$message,label:t.$tc("settings.preferences.fiscal_year"),required:""},{default:u(()=>[s(c,{modelValue:e(n).fiscal_year,"onUpdate:modelValue":a[4]||(a[4]=o=>e(n).fiscal_year=o),"content-loading":e(d),options:e(l).config.fiscal_years,label:"key","value-prop":"value",invalid:e(r).fiscal_year.$error,"track-by":"key",searchable:!0,class:"w-full"},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["content-loading","error","label"])]),_:1}),s(I,{"content-loading":e(d),disabled:e(v),loading:e(v),type:"submit",class:"mt-6"},{left:u(o=>[s(C,{name:"SaveIcon",class:E(o.class)},null,8,["class"])]),default:u(()=>[F(" "+N(t.$tc("settings.company_info.save")),1)]),_:1},8,["content-loading","disabled","loading"]),s(D,{class:"mt-6 mb-2"}),O("ul",null,[O("form",{onSubmit:Y(x,["prevent"])},[s(B,{modelValue:e(V),"onUpdate:modelValue":a[5]||(a[5]=o=>h(V)?V.value=o:null),title:t.$t("settings.preferences.expire_public_links"),description:t.$t("settings.preferences.expire_setting_description")},null,8,["modelValue","title","description"]),e(V)?(z(),ee(_,{key:0,"content-loading":e(d),label:t.$t("settings.preferences.expire_public_links"),class:"mt-2 mb-4"},{default:u(()=>[s(Z,{modelValue:e(n).link_expiry_days,"onUpdate:modelValue":a[6]||(a[6]=o=>e(n).link_expiry_days=o),disabled:e(n).automatically_expire_public_links==="NO","content-loading":e(d),type:"number"},null,8,["modelValue","disabled","content-loading"])]),_:1},8,["content-loading","label"])):te("",!0),s(I,{"content-loading":e(d),disabled:e($),loading:e($),type:"submit",class:"mt-6"},{left:u(o=>[s(C,{name:"SaveIcon",class:E(o.class)},null,8,["class"])]),default:u(()=>[F(" "+N(t.$tc("general.save")),1)]),_:1},8,["content-loading","disabled","loading"])],40,le),s(D,{class:"mt-6 mb-2"}),s(B,{modelValue:e(S),"onUpdate:modelValue":a[7]||(a[7]=o=>h(S)?S.value=o:null),title:t.$t("settings.preferences.discount_per_item"),description:t.$t("settings.preferences.discount_setting_description")},null,8,["modelValue","title","description"]),s(B,{modelValue:e(k),"onUpdate:modelValue":a[8]||(a[8]=o=>h(k)?k.value=o:null),title:t.$t("settings.preferences.transport_option"),description:t.$t("settings.preferences.transport_option_description")},null,8,["modelValue","title","description"])])]),_:1},8,["title","description"])],40,se)}}};export{ue as default};
