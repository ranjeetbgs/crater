var oe=Object.defineProperty,le=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var q=(w,r,t)=>r in w?oe(w,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):w[r]=t,W=(w,r)=>{for(var t in r||(r={}))ce.call(r,t)&&q(w,t,r[t]);if(G)for(var t of G(r))ie.call(r,t)&&q(w,t,r[t]);return w},J=(w,r)=>le(w,re(r));import{z as O,C as z,B as F,a0 as R,X as de,k as D,r as d,o as n,e as B,h as l,f as s,w as o,u as e,t as $,l as _,F as K,y as Q,j as p,m as Z,i as j,ah as ee,Y as ue,x as me,aN as _e}from"./vendor.5f3776de.js";import{l as L,_ as pe,b as fe,e as te,g as V,j as he}from"./main.ff095ef1.js";import{L as ye}from"./LoadingIcon.41aedf34.js";import{_ as ge}from"./LineChart.e8fc8ae2.js";import{_ as be}from"./CustomerIndexDropdown.f013875b.js";const xe={class:"fixed top-0 left-0 hidden h-full pt-16 pb-[6.6rem] ml-56 bg-white xl:ml-64 w-88 xl:block"},ve={class:"flex items-center justify-between px-4 pt-8 pb-2 border border-gray-200 border-solid height-full"},Be={class:"flex mb-6 ml-3",role:"group","aria-label":"First group"},$e={class:"px-4 py-3 pb-2 mb-2 text-sm border-b border-gray-200 border-solid"},we={class:"px-2"},Ce={class:"px-2"},ke={class:"flex-1 font-bold text-right whitespace-nowrap"},Te={key:0,class:"flex justify-center p-4 items-center"},Ee={key:1,class:"flex justify-center px-4 mt-5 text-sm text-gray-600"},Ie={setup(w){const r=L(),t=O(),{t:m}=z();let c=F(!1),a=R({orderBy:null,orderByField:null,searchText:null});const f=F(null),h=F(1),b=F(1),y=F(null);u=de.exports.debounce(u,500);const x=D(()=>a.orderBy==="asc"||a.orderBy==null);D(()=>x.value?m("general.ascending"):m("general.descending"));function C(i){return t.params.id==i}async function v(i,T=!1){if(c.value)return;let E={};a.searchText!==""&&a.searchText!==null&&a.searchText!==void 0&&(E.display_name=a.searchText),a.orderBy!==null&&a.orderBy!==void 0&&(E.orderBy=a.orderBy),a.orderByField!==null&&a.orderByField!==void 0&&(E.orderByField=a.orderByField),c.value=!0;let P=await r.fetchCustomers(J(W({page:i},E),{limit:15}));c.value=!1,f.value=f.value?f.value:[],f.value=[...f.value,...P.data.data],h.value=i||1,b.value=P.data.meta.last_page;let A=f.value.find(M=>M.id==t.params.id);T==!1&&!A&&h.value<b.value&&Object.keys(E).length===0&&v(++h.value),A&&setTimeout(()=>{T==!1&&k()},500)}function k(){const i=document.getElementById(`customer-${t.params.id}`);i&&(i.scrollIntoView({behavior:"smooth"}),i.classList.add("shake"),S())}function S(){y.value.addEventListener("scroll",i=>{i.target.scrollTop>0&&i.target.scrollTop+i.target.clientHeight>i.target.scrollHeight-200&&h.value<b.value&&v(++h.value,!0)})}async function u(){f.value=[],v()}function I(){return a.orderBy==="asc"?(a.orderBy="desc",u(),!0):(a.orderBy="asc",u(),!0)}return v(),(i,T)=>{var X;const E=d("BaseIcon"),P=d("BaseInput"),A=d("BaseButton"),M=d("BaseRadio"),U=d("BaseInputGroup"),H=d("BaseDropdownItem"),se=d("BaseDropdown"),Y=d("BaseText"),ae=d("BaseFormatMoney"),ne=d("router-link");return n(),B("div",xe,[l("div",ve,[s(P,{modelValue:e(a).searchText,"onUpdate:modelValue":T[0]||(T[0]=g=>e(a).searchText=g),placeholder:i.$t("general.search"),"container-class":"mb-6",type:"text",variant:"gray",onInput:T[1]||(T[1]=g=>u())},{default:o(()=>[s(E,{name:"SearchIcon",class:"text-gray-500"})]),_:1},8,["modelValue","placeholder"]),l("div",Be,[s(se,{"close-on-select":!1,position:"bottom-start","width-class":"w-40","position-class":"left-0"},{activator:o(()=>[s(A,{variant:"gray"},{default:o(()=>[s(E,{name:"FilterIcon"})]),_:1})]),default:o(()=>[l("div",$e,$(i.$t("general.sort_by")),1),l("div",we,[s(H,{class:"flex px-1 py-2 mt-1 cursor-pointer hover:rounded-md"},{default:o(()=>[s(U,{class:"pt-2 -mt-4"},{default:o(()=>[s(M,{id:"filter_create_date",modelValue:e(a).orderByField,"onUpdate:modelValue":[T[2]||(T[2]=g=>e(a).orderByField=g),u],label:i.$t("customers.create_date"),size:"sm",name:"filter",value:"invoices.created_at"},null,8,["modelValue","label"])]),_:1})]),_:1})]),l("div",Ce,[s(H,{class:"flex px-1 cursor-pointer hover:rounded-md"},{default:o(()=>[s(U,{class:"pt-2 -mt-4"},{default:o(()=>[s(M,{id:"filter_display_name",modelValue:e(a).orderByField,"onUpdate:modelValue":[T[3]||(T[3]=g=>e(a).orderByField=g),u],label:i.$t("customers.display_name"),size:"sm",name:"filter",value:"name"},null,8,["modelValue","label"])]),_:1})]),_:1})])]),_:1}),s(A,{class:"ml-1",size:"md",variant:"gray",onClick:I},{default:o(()=>[e(x)?(n(),_(E,{key:0,name:"SortAscendingIcon"})):(n(),_(E,{key:1,name:"SortDescendingIcon"}))]),_:1})])]),l("div",{ref:(g,N)=>{N.customerListSection=g,y.value=g},class:"h-full overflow-y-scroll border-l border-gray-200 border-solid sidebar base-scroll"},[(n(!0),B(K,null,Q(f.value,(g,N)=>(n(),B("div",{key:N},[g?(n(),_(ne,{key:0,id:"customer-"+g.id,to:`/admin/customers/${g.id}/view`,class:Z(["flex justify-between p-4 items-center cursor-pointer hover:bg-gray-100 border-l-4 border-transparent",{"bg-gray-100 border-l-4 border-primary-500 border-solid":C(g.id)}]),style:{"border-top":"1px solid rgba(185, 193, 209, 0.41)"}},{default:o(()=>[l("div",null,[s(Y,{text:g.name,length:30,class:"pr-2 text-sm not-italic font-normal leading-5 text-black capitalize truncate"},null,8,["text"]),g.contact_name?(n(),_(Y,{key:0,text:g.contact_name,length:30,class:"mt-1 text-xs not-italic font-medium leading-5 text-gray-600"},null,8,["text"])):p("",!0)]),l("div",ke,[s(ae,{amount:g.due_amount!==null?g.due_amount:0,currency:g.currency},null,8,["amount","currency"])])]),_:2},1032,["id","to","class"])):p("",!0)]))),128)),e(c)?(n(),B("div",Te,[s(ye,{class:"h-6 m-1 animate-spin text-primary-400"})])):p("",!0),!((X=f.value)==null?void 0:X.length)&&!e(c)?(n(),B("p",Ee,$(i.$t("customers.no_matching_customers")),1)):p("",!0)],512)])}}},De={class:"pt-6 mt-5 border-t border-solid lg:pt-8 md:pt-4 border-gray-200"},Ve={key:0,class:"text-sm font-bold leading-5 text-black non-italic"},Se={key:0},je={key:1},Ae={key:1,class:"text-sm font-bold leading-5 text-black non-italic"},Fe={setup(w){const r=L(),t=D(()=>r.selectedViewCustomer),m=D(()=>r.isFetchingViewData),c=D(()=>{var a,f;return((a=t==null?void 0:t.value)==null?void 0:a.fields)?(f=t==null?void 0:t.value)==null?void 0:f.fields:[]});return(a,f)=>{const h=d("BaseHeading"),b=d("BaseDescriptionListItem"),y=d("BaseDescriptionList"),x=d("BaseCustomerAddressDisplay");return n(),B("div",De,[s(h,null,{default:o(()=>[j($(a.$t("customers.basic_info")),1)]),_:1}),s(y,null,{default:o(()=>{var C,v,k;return[s(b,{"content-loading":e(m),label:a.$t("customers.display_name"),value:(C=e(t))==null?void 0:C.name},null,8,["content-loading","label","value"]),s(b,{"content-loading":e(m),label:a.$t("customers.primary_contact_name"),value:(v=e(t))==null?void 0:v.contact_name},null,8,["content-loading","label","value"]),s(b,{"content-loading":e(m),label:a.$t("customers.email"),value:(k=e(t))==null?void 0:k.email},null,8,["content-loading","label","value"])]}),_:1}),s(y,{class:"mt-5"},{default:o(()=>{var C,v,k,S,u,I,i;return[s(b,{"content-loading":e(m),label:a.$t("wizard.currency"),value:((C=e(t))==null?void 0:C.currency)?`${(k=(v=e(t))==null?void 0:v.currency)==null?void 0:k.code} (${(u=(S=e(t))==null?void 0:S.currency)==null?void 0:u.symbol})`:""},null,8,["content-loading","label","value"]),s(b,{"content-loading":e(m),label:a.$t("customers.phone_number"),value:(I=e(t))==null?void 0:I.phone},null,8,["content-loading","label","value"]),s(b,{"content-loading":e(m),label:a.$t("customers.website"),value:(i=e(t))==null?void 0:i.website},null,8,["content-loading","label","value"])]}),_:1}),e(t).billing||e(t).shipping?(n(),_(h,{key:0,class:"mt-8"},{default:o(()=>[j($(a.$t("customers.address")),1)]),_:1})):p("",!0),s(y,{class:"mt-5"},{default:o(()=>[e(t).billing?(n(),_(b,{key:0,"content-loading":e(m),label:a.$t("customers.billing_address")},{default:o(()=>[s(x,{address:e(t).billing},null,8,["address"])]),_:1},8,["content-loading","label"])):p("",!0),e(t).shipping?(n(),_(b,{key:1,"content-loading":e(m),label:a.$t("customers.shipping_address")},{default:o(()=>[s(x,{address:e(t).shipping},null,8,["address"])]),_:1},8,["content-loading","label"])):p("",!0)]),_:1}),e(c).length>0?(n(),_(h,{key:1,class:"mt-8"},{default:o(()=>[j($(a.$t("settings.custom_fields.title")),1)]),_:1})):p("",!0),s(y,{class:"mt-5"},{default:o(()=>[(n(!0),B(K,null,Q(e(c),(C,v)=>(n(),_(b,{key:v,"content-loading":e(m),label:C.custom_field.label},{default:o(()=>[C.type==="Switch"?(n(),B("p",Ve,[C.default_answer===1?(n(),B("span",Se," Yes ")):(n(),B("span",je," No "))])):(n(),B("p",Ae,$(C.default_answer),1))]),_:2},1032,["content-loading","label"]))),128))]),_:1})])}}},Pe={},Le={class:"col-span-12 xl:col-span-9 xxl:col-span-10"},Me={class:"flex justify-between mt-1 mb-6"},Re={class:"grid col-span-12 mt-6 text-center xl:mt-0 sm:grid-cols-4 xl:text-right xl:col-span-3 xl:grid-cols-1 xxl:col-span-2"},Ne={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"},Oe={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"},ze={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"},Ue={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"};function He(w,r){const t=d("BaseContentPlaceholdersText"),m=d("BaseContentPlaceholdersBox"),c=d("BaseContentPlaceholders");return n(),_(c,{class:"grid grid-cols-12"},{default:o(()=>[l("div",Le,[l("div",Me,[s(t,{class:"h-10 w-36",lines:1}),s(t,{class:"h-10 w-40 !mt-0",lines:1})]),s(m,{class:"h-80 xl:h-72 sm:w-full"})]),l("div",Re,[l("div",Ne,[s(t,{class:"h-3 w-14 xl:h-4",lines:1}),s(t,{class:"w-20 h-5 xl:h-6",lines:1})]),l("div",Oe,[s(t,{class:"h-3 w-14 xl:h-4",lines:1}),s(t,{class:"w-20 h-5 xl:h-6",lines:1})]),l("div",ze,[s(t,{class:"h-3 w-14 xl:h-4",lines:1}),s(t,{class:"w-20 h-5 xl:h-6",lines:1})]),l("div",Ue,[s(t,{class:"h-3 w-14 xl:h-4",lines:1}),s(t,{class:"w-20 h-5 xl:h-6",lines:1})])])]),_:1})}var Ye=pe(Pe,[["render",He]]);const Xe={key:1,class:"grid grid-cols-12"},Ge={class:"col-span-12 xl:col-span-9 xxl:col-span-10"},qe={class:"flex justify-between mt-1 mb-6"},We={class:"flex items-center"},Je={class:"w-40 h-10"},Ke={class:"grid col-span-12 mt-6 text-center xl:mt-0 sm:grid-cols-4 xl:text-right xl:col-span-3 xl:grid-cols-1 xxl:col-span-2"},Qe={class:"px-6 py-2"},Ze={class:"text-xs leading-5 lg:text-sm"},et=l("br",null,null,-1),tt={key:0,class:"block mt-1 text-xl font-semibold leading-8"},st={class:"px-6 py-2"},at={class:"text-xs leading-5 lg:text-sm"},nt=l("br",null,null,-1),ot={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#00c99c"}},lt={class:"px-6 py-2"},rt={class:"text-xs leading-5 lg:text-sm"},ct=l("br",null,null,-1),it={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#fb7178"}},dt={class:"px-6 py-2"},ut={class:"text-xs leading-5 lg:text-sm"},mt=l("br",null,null,-1),_t={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#5851d8"}},pt={setup(w){fe();const r=L();ee("utils");const t=O();let m=F(!1),c=R({}),a=R({}),f=R(["This year","Previous year"]),h=F("This year");const b=D(()=>c.expenseTotals?c.expenseTotals:[]),y=D(()=>c.netProfits?c.netProfits:[]),x=D(()=>c&&c.months?c.months:[]),C=D(()=>c.receiptTotals?c.receiptTotals:[]),v=D(()=>c.invoiceTotals?c.invoiceTotals:[]);ue(t,()=>{t.params.id&&k(),h.value="This year"},{immediate:!0});async function k(){m.value=!1;let u=await r.fetchViewCustomer({id:t.params.id});u.data&&(Object.assign(c,u.data.meta.chartData),Object.assign(a,u.data.data)),m.value=!0}async function S(u){let I={id:t.params.id};u==="Previous year"?I.previous_year=!0:I.this_year=!0;let i=await r.fetchViewCustomer(I);return i.data.meta.chartData&&Object.assign(c,i.data.meta.chartData),!0}return(u,I)=>{const i=d("BaseIcon"),T=d("BaseMultiselect"),E=d("BaseFormatMoney"),P=d("BaseCard");return n(),_(P,{class:"flex flex-col mt-6"},{default:o(()=>[e(r).isFetchingViewData?(n(),_(Ye,{key:0})):(n(),B("div",Xe,[l("div",Ge,[l("div",qe,[l("h6",We,[s(i,{name:"ChartSquareBarIcon",class:"h-5 text-primary-400"}),j(" "+$(u.$t("dashboard.monthly_chart.title")),1)]),l("div",Je,[s(T,{modelValue:e(h),"onUpdate:modelValue":I[0]||(I[0]=A=>me(h)?h.value=A:h=A),options:e(f),"allow-empty":!1,"show-labels":!1,placeholder:u.$t("dashboard.select_year"),"can-deselect":!1,onSelect:S},null,8,["modelValue","options","placeholder"])])]),e(m)?(n(),_(ge,{key:0,invoices:e(v),expenses:e(b),receipts:e(C),income:e(y),labels:e(x),class:"sm:w-full"},null,8,["invoices","expenses","receipts","income","labels"])):p("",!0)]),l("div",Ke,[l("div",Qe,[l("span",Ze,$(u.$t("dashboard.chart_info.total_sales")),1),et,e(m)?(n(),B("span",tt,[s(E,{amount:e(c).salesTotal,currency:e(a).currency},null,8,["amount","currency"])])):p("",!0)]),l("div",st,[l("span",at,$(u.$t("dashboard.chart_info.total_receipts")),1),nt,e(m)?(n(),B("span",ot,[s(E,{amount:e(c).totalExpenses,currency:e(a).currency},null,8,["amount","currency"])])):p("",!0)]),l("div",lt,[l("span",rt,$(u.$t("dashboard.chart_info.total_expense")),1),ct,e(m)?(n(),B("span",it,[s(E,{amount:e(c).totalExpenses,currency:e(a).currency},null,8,["amount","currency"])])):p("",!0)]),l("div",dt,[l("span",ut,$(u.$t("dashboard.chart_info.net_income")),1),mt,e(m)?(n(),B("span",_t,[s(E,{amount:e(c).netProfit,currency:e(a).currency},null,8,["amount","currency"])])):p("",!0)])])])),s(Fe)]),_:1})}}},ft={key:0,class:"mt-6",style:{zoom:"95%"}},ht=l("div",{class:"relative z-10 flex items-center justify-between mb-3"},[l("h6",{class:"mb-0 text-xl font-semibold leading-normal"}," Ledger ")],-1),yt=["innerHTML","title"],gt={setup(w){const r=L(),{t}=z(),m=te(),c=D(()=>[{key:"id",label:t("dashboard.recent_invoices_card.due_on"),sortable:!1},{key:"formatted_date",label:"Date",sortable:!1},{key:"notes",label:"Note",thClass:"extra w-10 pr-0",tdClass:"truncate max-w-xs",sortable:!1},{key:"credit",label:"Credit",sortable:!1},{key:"debit",label:"Debit",sortable:!1}]);return(a,f)=>{const h=d("BaseFormatMoney"),b=d("BaseTable");return e(m).hasAbilities(e(V).VIEW_INVOICE)?(n(),B("div",ft,[ht,s(b,{data:e(r).selectedViewCustomer.ledger,columns:e(c),loading:e(r).isFetchingViewData},{"cell-notes":o(({row:y})=>[l("span",{innerHTML:y.data.notes,title:y.data.notes},null,8,yt)]),"cell-credit":o(({row:y})=>[y.data.credit?(n(),_(h,{key:0,amount:y.data.credit,currency:e(r).selectedViewCustomer.currency},null,8,["amount","currency"])):p("",!0)]),"cell-debit":o(({row:y})=>[y.data.debit?(n(),_(h,{key:0,amount:y.data.debit,currency:e(r).selectedViewCustomer.currency},null,8,["amount","currency"])):p("",!0)]),_:1},8,["data","columns","loading"])])):p("",!0)}}},Ct={setup(w){ee("utils"),he();const r=L(),t=te();z();const m=_e(),c=O();F(null);const a=D(()=>r.selectedViewCustomer.customer?r.selectedViewCustomer.customer.name:"");let f=D(()=>r.isFetchingViewData);function h(){return t.hasAbilities([V.CREATE_ESTIMATE,V.CREATE_INVOICE,V.CREATE_PAYMENT,V.CREATE_EXPENSE])}function b(){return t.hasAbilities([V.DELETE_CUSTOMER,V.EDIT_CUSTOMER])}function y(){m.push("/admin/customers")}return(x,C)=>{const v=d("BaseButton"),k=d("router-link"),S=d("BaseIcon"),u=d("BaseDropdownItem"),I=d("BaseDropdown"),i=d("BasePageHeader"),T=d("BasePage");return n(),_(T,{class:"xl:pl-96"},{default:o(()=>[s(i,{title:e(a)},{actions:o(()=>[e(t).hasAbilities(e(V).EDIT_CUSTOMER)?(n(),_(k,{key:0,to:`/admin/customers/${e(c).params.id}/edit`},{default:o(()=>[s(v,{class:"mr-3",variant:"primary-outline","content-loading":e(f)},{default:o(()=>[j($(x.$t("general.edit")),1)]),_:1},8,["content-loading"])]),_:1},8,["to"])):p("",!0),h()?(n(),_(I,{key:1,position:"bottom-end","content-loading":e(f)},{activator:o(()=>[s(v,{class:"mr-3",variant:"primary","content-loading":e(f)},{default:o(()=>[j($(x.$t("customers.new_transaction")),1)]),_:1},8,["content-loading"])]),default:o(()=>[e(t).hasAbilities(e(V).CREATE_ESTIMATE)?(n(),_(k,{key:0,to:`/admin/estimates/create?customer=${x.$route.params.id}`},{default:o(()=>[s(u,{class:""},{default:o(()=>[s(S,{name:"DocumentIcon",class:"mr-3 text-gray-600"}),j(" "+$(x.$t("estimates.new_estimate")),1)]),_:1})]),_:1},8,["to"])):p("",!0),e(t).hasAbilities(e(V).CREATE_INVOICE)?(n(),_(k,{key:1,to:`/admin/invoices/create?customer=${x.$route.params.id}`},{default:o(()=>[s(u,null,{default:o(()=>[s(S,{name:"DocumentTextIcon",class:"mr-3 text-gray-600"}),j(" "+$(x.$t("invoices.new_invoice")),1)]),_:1})]),_:1},8,["to"])):p("",!0),e(t).hasAbilities(e(V).CREATE_PAYMENT)?(n(),_(k,{key:2,to:`/admin/payments/create?customer=${x.$route.params.id}`},{default:o(()=>[s(u,null,{default:o(()=>[s(S,{name:"CreditCardIcon",class:"mr-3 text-gray-600"}),j(" "+$(x.$t("payments.new_payment")),1)]),_:1})]),_:1},8,["to"])):p("",!0),e(t).hasAbilities(e(V).CREATE_EXPENSE)?(n(),_(k,{key:3,to:`/admin/expenses/create?customer=${x.$route.params.id}`},{default:o(()=>[s(u,null,{default:o(()=>[s(S,{name:"CalculatorIcon",class:"mr-3 text-gray-600"}),j(" "+$(x.$t("expenses.new_expense")),1)]),_:1})]),_:1},8,["to"])):p("",!0)]),_:1},8,["content-loading"])):p("",!0),b()?(n(),_(be,{key:2,class:Z({"ml-3":e(f)}),row:e(r).selectedViewCustomer,"load-data":y},null,8,["class","row"])):p("",!0)]),_:1},8,["title"]),s(Ie),s(pt),s(gt)]),_:1})}}};export{Ct as default};
