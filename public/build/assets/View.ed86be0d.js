var oe=Object.defineProperty,le=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var q=(k,r,s)=>r in k?oe(k,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):k[r]=s,W=(k,r)=>{for(var s in r||(r={}))ce.call(r,s)&&q(k,s,r[s]);if(G)for(var s of G(r))ie.call(r,s)&&q(k,s,r[s]);return k},J=(k,r)=>le(k,re(r));import{z as O,C as z,B as F,a0 as R,X as de,k as D,r as i,o,e as $,h as l,f as t,w as n,u as e,t as w,l as p,F as K,y as Q,j as f,m as Z,i as j,ah as ee,Y as ue,x as me,aN as _e}from"./vendor.5f3776de.js";import{l as L,_ as pe,b as fe,e as te,g as V,j as he}from"./main.84e42544.js";import{L as ye}from"./LoadingIcon.fad0ae4f.js";import{_ as ge}from"./LineChart.462a4b30.js";import{_ as be}from"./CustomerIndexDropdown.546f9fce.js";const xe={class:"fixed top-0 left-0 hidden h-full pt-16 pb-[6.6rem] ml-56 bg-white xl:ml-64 w-88 xl:block"},ve={class:"flex items-center justify-between px-4 pt-8 pb-2 border border-gray-200 border-solid height-full"},Be={class:"flex mb-6 ml-3",role:"group","aria-label":"First group"},$e={class:"px-4 py-3 pb-2 mb-2 text-sm border-b border-gray-200 border-solid"},we={class:"px-2"},ke={class:"px-2"},Ce={class:"flex-1 font-bold text-right whitespace-nowrap"},Te={key:0,class:"flex justify-center p-4 items-center"},Ee={key:1,class:"flex justify-center px-4 mt-5 text-sm text-gray-600"},Ie={setup(k){const r=L(),s=O(),{t:_}=z();let c=F(!1),a=R({orderBy:null,orderByField:null,searchText:null});const h=F(null),x=F(1),v=F(1),E=F(null);u=de.exports.debounce(u,500);const y=D(()=>a.orderBy==="asc"||a.orderBy==null);D(()=>y.value?_("general.ascending"):_("general.descending"));function m(d){return s.params.id==d}async function g(d,C=!1){if(c.value)return;let T={};a.searchText!==""&&a.searchText!==null&&a.searchText!==void 0&&(T.display_name=a.searchText),a.orderBy!==null&&a.orderBy!==void 0&&(T.orderBy=a.orderBy),a.orderByField!==null&&a.orderByField!==void 0&&(T.orderByField=a.orderByField),c.value=!0;let P=await r.fetchCustomers(J(W({page:d},T),{limit:15}));c.value=!1,h.value=h.value?h.value:[],h.value=[...h.value,...P.data.data],x.value=d||1,v.value=P.data.meta.last_page;let A=h.value.find(M=>M.id==s.params.id);C==!1&&!A&&x.value<v.value&&Object.keys(T).length===0&&g(++x.value),A&&setTimeout(()=>{C==!1&&B()},500)}function B(){const d=document.getElementById(`customer-${s.params.id}`);d&&(d.scrollIntoView({behavior:"smooth"}),d.classList.add("shake"),S())}function S(){E.value.addEventListener("scroll",d=>{d.target.scrollTop>0&&d.target.scrollTop+d.target.clientHeight>d.target.scrollHeight-200&&x.value<v.value&&g(++x.value,!0)})}async function u(){h.value=[],g()}function I(){return a.orderBy==="asc"?(a.orderBy="desc",u(),!0):(a.orderBy="asc",u(),!0)}return g(),(d,C)=>{var X;const T=i("BaseIcon"),P=i("BaseInput"),A=i("BaseButton"),M=i("BaseRadio"),U=i("BaseInputGroup"),H=i("BaseDropdownItem"),se=i("BaseDropdown"),Y=i("BaseText"),ae=i("BaseFormatMoney"),ne=i("router-link");return o(),$("div",xe,[l("div",ve,[t(P,{modelValue:e(a).searchText,"onUpdate:modelValue":C[0]||(C[0]=b=>e(a).searchText=b),placeholder:d.$t("general.search"),"container-class":"mb-6",type:"text",variant:"gray",onInput:C[1]||(C[1]=b=>u())},{default:n(()=>[t(T,{name:"SearchIcon",class:"text-gray-500"})]),_:1},8,["modelValue","placeholder"]),l("div",Be,[t(se,{"close-on-select":!1,position:"bottom-start","width-class":"w-40","position-class":"left-0"},{activator:n(()=>[t(A,{variant:"gray"},{default:n(()=>[t(T,{name:"FilterIcon"})]),_:1})]),default:n(()=>[l("div",$e,w(d.$t("general.sort_by")),1),l("div",we,[t(H,{class:"flex px-1 py-2 mt-1 cursor-pointer hover:rounded-md"},{default:n(()=>[t(U,{class:"pt-2 -mt-4"},{default:n(()=>[t(M,{id:"filter_create_date",modelValue:e(a).orderByField,"onUpdate:modelValue":[C[2]||(C[2]=b=>e(a).orderByField=b),u],label:d.$t("customers.create_date"),size:"sm",name:"filter",value:"invoices.created_at"},null,8,["modelValue","label"])]),_:1})]),_:1})]),l("div",ke,[t(H,{class:"flex px-1 cursor-pointer hover:rounded-md"},{default:n(()=>[t(U,{class:"pt-2 -mt-4"},{default:n(()=>[t(M,{id:"filter_display_name",modelValue:e(a).orderByField,"onUpdate:modelValue":[C[3]||(C[3]=b=>e(a).orderByField=b),u],label:d.$t("customers.display_name"),size:"sm",name:"filter",value:"name"},null,8,["modelValue","label"])]),_:1})]),_:1})])]),_:1}),t(A,{class:"ml-1",size:"md",variant:"gray",onClick:I},{default:n(()=>[e(y)?(o(),p(T,{key:0,name:"SortAscendingIcon"})):(o(),p(T,{key:1,name:"SortDescendingIcon"}))]),_:1})])]),l("div",{ref:(b,N)=>{N.customerListSection=b,E.value=b},class:"h-full overflow-y-scroll border-l border-gray-200 border-solid sidebar base-scroll"},[(o(!0),$(K,null,Q(h.value,(b,N)=>(o(),$("div",{key:N},[b?(o(),p(ne,{key:0,id:"customer-"+b.id,to:`/admin/customers/${b.id}/view`,class:Z(["flex justify-between p-4 items-center cursor-pointer hover:bg-gray-100 border-l-4 border-transparent",{"bg-gray-100 border-l-4 border-primary-500 border-solid":m(b.id)}]),style:{"border-top":"1px solid rgba(185, 193, 209, 0.41)"}},{default:n(()=>[l("div",null,[t(Y,{text:b.name,length:30,class:"pr-2 text-sm not-italic font-normal leading-5 text-black capitalize truncate"},null,8,["text"]),b.contact_name?(o(),p(Y,{key:0,text:b.contact_name,length:30,class:"mt-1 text-xs not-italic font-medium leading-5 text-gray-600"},null,8,["text"])):f("",!0)]),l("div",Ce,[t(ae,{amount:b.due_amount!==null?b.due_amount:0,currency:b.currency},null,8,["amount","currency"])])]),_:2},1032,["id","to","class"])):f("",!0)]))),128)),e(c)?(o(),$("div",Te,[t(ye,{class:"h-6 m-1 animate-spin text-primary-400"})])):f("",!0),!((X=h.value)==null?void 0:X.length)&&!e(c)?(o(),$("p",Ee,w(d.$t("customers.no_matching_customers")),1)):f("",!0)],512)])}}},De={class:"pt-6 mt-5 border-t border-solid lg:pt-8 md:pt-4 border-gray-200"},Ve={key:0,class:"text-sm font-bold leading-5 text-black non-italic"},Se={key:0},je={key:1},Ae={key:1,class:"text-sm font-bold leading-5 text-black non-italic"},Fe={setup(k){const r=L(),s=D(()=>r.selectedViewCustomer),_=D(()=>r.isFetchingViewData),c=D(()=>{var a,h;return((a=s==null?void 0:s.value)==null?void 0:a.fields)?(h=s==null?void 0:s.value)==null?void 0:h.fields:[]});return(a,h)=>{const x=i("BaseHeading"),v=i("BaseDescriptionListItem"),E=i("BaseDescriptionList"),y=i("BaseCustomerAddressDisplay");return o(),$("div",De,[t(x,null,{default:n(()=>[j(w(a.$t("customers.basic_info")),1)]),_:1}),t(E,null,{default:n(()=>{var m,g,B;return[t(v,{"content-loading":e(_),label:a.$t("customers.display_name"),value:(m=e(s))==null?void 0:m.name},null,8,["content-loading","label","value"]),t(v,{"content-loading":e(_),label:a.$t("customers.primary_contact_name"),value:(g=e(s))==null?void 0:g.contact_name},null,8,["content-loading","label","value"]),t(v,{"content-loading":e(_),label:a.$t("customers.email"),value:(B=e(s))==null?void 0:B.email},null,8,["content-loading","label","value"])]}),_:1}),t(E,{class:"mt-5"},{default:n(()=>{var m,g,B,S,u,I,d;return[t(v,{"content-loading":e(_),label:a.$t("wizard.currency"),value:((m=e(s))==null?void 0:m.currency)?`${(B=(g=e(s))==null?void 0:g.currency)==null?void 0:B.code} (${(u=(S=e(s))==null?void 0:S.currency)==null?void 0:u.symbol})`:""},null,8,["content-loading","label","value"]),t(v,{"content-loading":e(_),label:a.$t("customers.phone_number"),value:(I=e(s))==null?void 0:I.phone},null,8,["content-loading","label","value"]),t(v,{"content-loading":e(_),label:a.$t("customers.website"),value:(d=e(s))==null?void 0:d.website},null,8,["content-loading","label","value"])]}),_:1}),e(s).billing||e(s).shipping?(o(),p(x,{key:0,class:"mt-8"},{default:n(()=>[j(w(a.$t("customers.address")),1)]),_:1})):f("",!0),t(E,{class:"mt-5"},{default:n(()=>[e(s).billing?(o(),p(v,{key:0,"content-loading":e(_),label:a.$t("customers.billing_address")},{default:n(()=>[t(y,{address:e(s).billing},null,8,["address"])]),_:1},8,["content-loading","label"])):f("",!0),e(s).shipping?(o(),p(v,{key:1,"content-loading":e(_),label:a.$t("customers.shipping_address")},{default:n(()=>[t(y,{address:e(s).shipping},null,8,["address"])]),_:1},8,["content-loading","label"])):f("",!0)]),_:1}),e(c).length>0?(o(),p(x,{key:1,class:"mt-8"},{default:n(()=>[j(w(a.$t("settings.custom_fields.title")),1)]),_:1})):f("",!0),t(E,{class:"mt-5"},{default:n(()=>[(o(!0),$(K,null,Q(e(c),(m,g)=>(o(),p(v,{key:g,"content-loading":e(_),label:m.custom_field.label},{default:n(()=>[m.type==="Switch"?(o(),$("p",Ve,[m.default_answer===1?(o(),$("span",Se," Yes ")):(o(),$("span",je," No "))])):(o(),$("p",Ae,w(m.default_answer),1))]),_:2},1032,["content-loading","label"]))),128))]),_:1})])}}},Pe={},Le={class:"col-span-12 xl:col-span-9 xxl:col-span-10"},Me={class:"flex justify-between mt-1 mb-6"},Re={class:"grid col-span-12 mt-6 text-center xl:mt-0 sm:grid-cols-4 xl:text-right xl:col-span-3 xl:grid-cols-1 xxl:col-span-2"},Ne={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"},Oe={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"},ze={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"},Ue={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"};function He(k,r){const s=i("BaseContentPlaceholdersText"),_=i("BaseContentPlaceholdersBox"),c=i("BaseContentPlaceholders");return o(),p(c,{class:"grid grid-cols-12"},{default:n(()=>[l("div",Le,[l("div",Me,[t(s,{class:"h-10 w-36",lines:1}),t(s,{class:"h-10 w-40 !mt-0",lines:1})]),t(_,{class:"h-80 xl:h-72 sm:w-full"})]),l("div",Re,[l("div",Ne,[t(s,{class:"h-3 w-14 xl:h-4",lines:1}),t(s,{class:"w-20 h-5 xl:h-6",lines:1})]),l("div",Oe,[t(s,{class:"h-3 w-14 xl:h-4",lines:1}),t(s,{class:"w-20 h-5 xl:h-6",lines:1})]),l("div",ze,[t(s,{class:"h-3 w-14 xl:h-4",lines:1}),t(s,{class:"w-20 h-5 xl:h-6",lines:1})]),l("div",Ue,[t(s,{class:"h-3 w-14 xl:h-4",lines:1}),t(s,{class:"w-20 h-5 xl:h-6",lines:1})])])]),_:1})}var Ye=pe(Pe,[["render",He]]);const Xe={key:1,class:"grid grid-cols-12"},Ge={class:"col-span-12 xl:col-span-9 xxl:col-span-10"},qe={class:"flex justify-between mt-1 mb-6"},We={class:"flex items-center"},Je={class:"w-40 h-10"},Ke={class:"grid col-span-12 mt-6 text-center xl:mt-0 sm:grid-cols-4 xl:text-right xl:col-span-3 xl:grid-cols-1 xxl:col-span-2"},Qe={class:"px-6 py-2"},Ze={class:"text-xs leading-5 lg:text-sm"},et=l("br",null,null,-1),tt={key:0,class:"block mt-1 text-xl font-semibold leading-8"},st={class:"px-6 py-2"},at={class:"text-xs leading-5 lg:text-sm"},nt=l("br",null,null,-1),ot={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#00c99c"}},lt={class:"px-6 py-2"},rt={class:"text-xs leading-5 lg:text-sm"},ct=l("br",null,null,-1),it={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#fb7178"}},dt={class:"px-6 py-2"},ut={class:"text-xs leading-5 lg:text-sm"},mt=l("br",null,null,-1),_t={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#5851d8"}},pt={setup(k){fe();const r=L();ee("utils");const s=O();let _=F(!1),c=R({}),a=R({}),h=R(["This year","Previous year"]),x=F("This year");const v=D(()=>c.expenseTotals?c.expenseTotals:[]),E=D(()=>c.netProfits?c.netProfits:[]),y=D(()=>c&&c.months?c.months:[]),m=D(()=>c.receiptTotals?c.receiptTotals:[]),g=D(()=>c.invoiceTotals?c.invoiceTotals:[]);ue(s,()=>{s.params.id&&B(),x.value="This year"},{immediate:!0});async function B(){_.value=!1;let u=await r.fetchViewCustomer({id:s.params.id});u.data&&(Object.assign(c,u.data.meta.chartData),Object.assign(a,u.data.data)),_.value=!0}async function S(u){let I={id:s.params.id};u==="Previous year"?I.previous_year=!0:I.this_year=!0;let d=await r.fetchViewCustomer(I);return d.data.meta.chartData&&Object.assign(c,d.data.meta.chartData),!0}return(u,I)=>{const d=i("BaseIcon"),C=i("BaseMultiselect"),T=i("BaseFormatMoney"),P=i("BaseCard");return o(),p(P,{class:"flex flex-col mt-6"},{default:n(()=>[e(r).isFetchingViewData?(o(),p(Ye,{key:0})):(o(),$("div",Xe,[l("div",Ge,[l("div",qe,[l("h6",We,[t(d,{name:"ChartSquareBarIcon",class:"h-5 text-primary-400"}),j(" "+w(u.$t("dashboard.monthly_chart.title")),1)]),l("div",Je,[t(C,{modelValue:e(x),"onUpdate:modelValue":I[0]||(I[0]=A=>me(x)?x.value=A:x=A),options:e(h),"allow-empty":!1,"show-labels":!1,placeholder:u.$t("dashboard.select_year"),"can-deselect":!1,onSelect:S},null,8,["modelValue","options","placeholder"])])]),e(_)?(o(),p(ge,{key:0,invoices:e(g),expenses:e(v),receipts:e(m),income:e(E),labels:e(y),class:"sm:w-full"},null,8,["invoices","expenses","receipts","income","labels"])):f("",!0)]),l("div",Ke,[l("div",Qe,[l("span",Ze,w(u.$t("dashboard.chart_info.total_sales")),1),et,e(_)?(o(),$("span",tt,[t(T,{amount:e(c).salesTotal,currency:e(a).currency},null,8,["amount","currency"])])):f("",!0)]),l("div",st,[l("span",at,w(u.$t("dashboard.chart_info.total_receipts")),1),nt,e(_)?(o(),$("span",ot,[t(T,{amount:e(c).totalExpenses,currency:e(a).currency},null,8,["amount","currency"])])):f("",!0)]),l("div",lt,[l("span",rt,w(u.$t("dashboard.chart_info.total_expense")),1),ct,e(_)?(o(),$("span",it,[t(T,{amount:e(c).totalExpenses,currency:e(a).currency},null,8,["amount","currency"])])):f("",!0)]),l("div",dt,[l("span",ut,w(u.$t("dashboard.chart_info.net_income")),1),mt,e(_)?(o(),$("span",_t,[t(T,{amount:e(c).netProfit,currency:e(a).currency},null,8,["amount","currency"])])):f("",!0)])])])),t(Fe)]),_:1})}}},ft={key:0,class:"mt-6",style:{zoom:"95%"}},ht=l("div",{class:"relative z-10 flex items-center justify-between mb-3"},[l("h6",{class:"mb-0 text-xl font-semibold leading-normal"}," Ledger ")],-1),yt=["innerHTML","title"],gt={setup(k){const r=L(),{t:s}=z(),_=te(),c=D(()=>[{key:"number",label:s("dashboard.recent_invoices_card.due_on"),sortable:!1},{key:"formatted_date",label:"Date",sortable:!1},{key:"notes",label:"Note",thClass:"extra w-10 pr-0",tdClass:"truncate max-w-xs",sortable:!1},{key:"credit",label:"Credit",sortable:!1},{key:"debit",label:"Debit",sortable:!1}]);return(a,h)=>{const x=i("BaseText"),v=i("router-link"),E=i("BaseFormatMoney"),y=i("BaseTable");return e(_).hasAbilities(e(V).VIEW_INVOICE)?(o(),$("div",ft,[ht,t(y,{data:e(r).selectedViewCustomer.ledger,columns:e(c),loading:e(r).isFetchingViewData},{"cell-number":n(({row:m})=>{var g;return[t(v,{to:{path:"/admin/"+((g=m.data)==null?void 0:g.url)}},{default:n(()=>{var B;return[t(x,{text:(B=m.data)==null?void 0:B.number,length:30,tag:"span",class:"font-medium text-primary-500 flex flex-col"},null,8,["text"])]}),_:2},1032,["to"])]}),"cell-notes":n(({row:m})=>[l("span",{innerHTML:m.data.notes,title:m.data.notes},null,8,yt)]),"cell-credit":n(({row:m})=>[m.data.credit?(o(),p(E,{key:0,amount:m.data.credit,currency:e(r).selectedViewCustomer.currency},null,8,["amount","currency"])):f("",!0)]),"cell-debit":n(({row:m})=>[m.data.debit?(o(),p(E,{key:0,amount:m.data.debit,currency:e(r).selectedViewCustomer.currency},null,8,["amount","currency"])):f("",!0)]),_:1},8,["data","columns","loading"])])):f("",!0)}}},kt={setup(k){ee("utils"),he();const r=L(),s=te();z();const _=_e(),c=O();F(null);const a=D(()=>r.selectedViewCustomer.customer?r.selectedViewCustomer.customer.name:"");let h=D(()=>r.isFetchingViewData);function x(){return s.hasAbilities([V.CREATE_ESTIMATE,V.CREATE_INVOICE,V.CREATE_PAYMENT,V.CREATE_EXPENSE])}function v(){return s.hasAbilities([V.DELETE_CUSTOMER,V.EDIT_CUSTOMER])}function E(){_.push("/admin/customers")}return(y,m)=>{const g=i("BaseButton"),B=i("router-link"),S=i("BaseIcon"),u=i("BaseDropdownItem"),I=i("BaseDropdown"),d=i("BasePageHeader"),C=i("BasePage");return o(),p(C,{class:"xl:pl-96"},{default:n(()=>[t(d,{title:e(a)},{actions:n(()=>[e(s).hasAbilities(e(V).EDIT_CUSTOMER)?(o(),p(B,{key:0,to:`/admin/customers/${e(c).params.id}/edit`},{default:n(()=>[t(g,{class:"mr-3",variant:"primary-outline","content-loading":e(h)},{default:n(()=>[j(w(y.$t("general.edit")),1)]),_:1},8,["content-loading"])]),_:1},8,["to"])):f("",!0),x()?(o(),p(I,{key:1,position:"bottom-end","content-loading":e(h)},{activator:n(()=>[t(g,{class:"mr-3",variant:"primary","content-loading":e(h)},{default:n(()=>[j(w(y.$t("customers.new_transaction")),1)]),_:1},8,["content-loading"])]),default:n(()=>[e(s).hasAbilities(e(V).CREATE_ESTIMATE)?(o(),p(B,{key:0,to:`/admin/estimates/create?customer=${y.$route.params.id}`},{default:n(()=>[t(u,{class:""},{default:n(()=>[t(S,{name:"DocumentIcon",class:"mr-3 text-gray-600"}),j(" "+w(y.$t("estimates.new_estimate")),1)]),_:1})]),_:1},8,["to"])):f("",!0),e(s).hasAbilities(e(V).CREATE_INVOICE)?(o(),p(B,{key:1,to:`/admin/invoices/create?customer=${y.$route.params.id}`},{default:n(()=>[t(u,null,{default:n(()=>[t(S,{name:"DocumentTextIcon",class:"mr-3 text-gray-600"}),j(" "+w(y.$t("invoices.new_invoice")),1)]),_:1})]),_:1},8,["to"])):f("",!0),e(s).hasAbilities(e(V).CREATE_PAYMENT)?(o(),p(B,{key:2,to:`/admin/payments/create?customer=${y.$route.params.id}`},{default:n(()=>[t(u,null,{default:n(()=>[t(S,{name:"CreditCardIcon",class:"mr-3 text-gray-600"}),j(" "+w(y.$t("payments.new_payment")),1)]),_:1})]),_:1},8,["to"])):f("",!0),e(s).hasAbilities(e(V).CREATE_EXPENSE)?(o(),p(B,{key:3,to:`/admin/expenses/create?customer=${y.$route.params.id}`},{default:n(()=>[t(u,null,{default:n(()=>[t(S,{name:"CalculatorIcon",class:"mr-3 text-gray-600"}),j(" "+w(y.$t("expenses.new_expense")),1)]),_:1})]),_:1},8,["to"])):f("",!0)]),_:1},8,["content-loading"])):f("",!0),v()?(o(),p(be,{key:2,class:Z({"ml-3":e(h)}),row:e(r).selectedViewCustomer,"load-data":E},null,8,["class","row"])):f("",!0)]),_:1},8,["title"]),t(Ie),t(pt),t(gt)]),_:1})}}};export{kt as default};
